<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<link href="coqdoc.css" rel="stylesheet" type="text/css"/>
<title>Fin</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library Fin</h1>

<div class="code">
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Export</span> <a class="idref" href="Compare.html#"><span class="id" type="library">Compare</span></a>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Export</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Vectors.Fin.html#"><span class="id" type="library">Coq.Vectors.Fin</span></a>.<br/>

<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Arith.Compare_dec.html#"><span class="id" type="library">Coq.Arith.Compare_dec</span></a>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Arith.Lt.html#"><span class="id" type="library">Coq.Arith.Lt</span></a>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Lists.List.html#"><span class="id" type="library">Coq.Lists.List</span></a>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Logic.ProofIrrelevance.html#"><span class="id" type="library">Coq.Logic.ProofIrrelevance</span></a>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Numbers.Natural.Peano.NPeano.html#"><span class="id" type="library">Coq.Numbers.Natural.Peano.NPeano</span></a>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Program.Equality.html#"><span class="id" type="library">Coq.Program.Equality</span></a>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Structures.Orders.html#"><span class="id" type="library">Coq.Structures.Orders</span></a>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.omega.Omega.html#"><span class="id" type="library">Coq.omega.Omega</span></a>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="nat_compare_gt_flip"><span class="id" type="lemma">nat_compare_gt_flip</span></a> : <span class="id" type="keyword">∀</span> (<span class="id" type="var">x</span> <span class="id" type="var">y</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Arith.Compare_dec.html#nat_compare"><span class="id" type="definition">nat_compare</span></a> <a class="idref" href="Fin.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Fin.html#y"><span class="id" type="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#Gt"><span class="id" type="constructor">Gt</span></a> → <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Arith.Compare_dec.html#nat_compare"><span class="id" type="definition">nat_compare</span></a> <a class="idref" href="Fin.html#y"><span class="id" type="variable">y</span></a> <a class="idref" href="Fin.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#Lt"><span class="id" type="constructor">Lt</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Arith.Compare_dec.html#nat_compare_lt"><span class="id" type="lemma">nat_compare_lt</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Arith.Compare_dec.html#nat_compare_gt"><span class="id" type="lemma">nat_compare_gt</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Program Instance</span> <a name="nat_CompareSpec"><span class="id" type="instance">nat_CompareSpec</span></a> : <a class="idref" href="Compare.html#CompareSpec"><span class="id" type="class">CompareSpec</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a> := {<br/>
&nbsp;&nbsp;<a class="idref" href="Compare.html#cmp"><span class="id" type="method">cmp</span></a>         := <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Arith.Compare_dec.html#nat_compare"><span class="id" type="definition">nat_compare</span></a>;<br/>
&nbsp;&nbsp;<a class="idref" href="Compare.html#cmp_eq_iff"><span class="id" type="method">cmp_eq_iff</span></a>  := <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Arith.Compare_dec.html#nat_compare_eq_iff"><span class="id" type="lemma">nat_compare_eq_iff</span></a>;<br/>
&nbsp;&nbsp;<a class="idref" href="Compare.html#cmp_gt_flip"><span class="id" type="method">cmp_gt_flip</span></a> := <a class="idref" href="Fin.html#nat_compare_gt_flip"><span class="id" type="lemma">nat_compare_gt_flip</span></a><br/>
}.<br/>

<br/>
</div>

<div class="doc">
<a name="lab2"></a><h2 class="section">Finite sets</h2>

</div>
<div class="code">

<br/>
<span class="id" type="keyword">Definition</span> <a name="fin"><span class="id" type="definition">fin</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Vectors.Fin.html#t"><span class="id" type="inductive">Coq.Vectors.Fin.t</span></a>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="fin_contra"><span class="id" type="definition">fin_contra</span></a> : <span class="id" type="keyword">∀</span> {<span class="id" type="var">x</span>}, <a class="idref" href="Fin.html#fin"><span class="id" type="definition">fin</span></a> 0 → <a class="idref" href="Fin.html#x"><span class="id" type="variable">x</span></a>.<br/>
<span class="id" type="keyword">Proof</span>. <span class="id" type="tactic">intros</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span>. <span class="id" type="keyword">Defined</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="from_nat"><span class="id" type="definition">from_nat</span></a> {<span class="id" type="var">m</span>} (<span class="id" type="var">n</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a>) (<span class="id" type="var">H</span> : <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Peano.html#:nat_scope:x_'<'_x"><span class="id" type="notation">&lt;</span></a> <a class="idref" href="Fin.html#m"><span class="id" type="variable">m</span></a>) : <a class="idref" href="Fin.html#fin"><span class="id" type="definition">fin</span></a> <a class="idref" href="Fin.html#m"><span class="id" type="variable">m</span></a> := @<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Vectors.Fin.html#of_nat_lt"><span class="id" type="definition">of_nat_lt</span></a> <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a> <a class="idref" href="Fin.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="Fin.html#H"><span class="id" type="variable">H</span></a>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="fin_to_nat"><span class="id" type="definition">fin_to_nat</span></a> {<span class="id" type="var">n</span>} (<span class="id" type="var">f</span> : <a class="idref" href="Fin.html#fin"><span class="id" type="definition">fin</span></a> <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a> := <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif.html#proj1_sig"><span class="id" type="definition">proj1_sig</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Vectors.Fin.html#to_nat"><span class="id" type="definition">to_nat</span></a> <a class="idref" href="Fin.html#f"><span class="id" type="variable">f</span></a>).<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="last_fin_from_nat"><span class="id" type="definition">last_fin_from_nat</span></a> (<span class="id" type="var">n</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a>) : <a class="idref" href="Fin.html#fin"><span class="id" type="definition">fin</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a>) := <a class="idref" href="Fin.html#from_nat"><span class="id" type="definition">from_nat</span></a> <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Peano.html#le_n"><span class="id" type="constructor">le_n</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a>)).<br/>

<br/>
</div>

<div class="doc">
Return the last possible inhabitant of a <span class="inlinecode"><a class="idref" href="Fin.html#fin"><span class="id" type="definition">fin</span></a></span> <span class="inlinecode"><a class="idref" href="Fin.html#FinOrder.n"><span class="id" type="axiom">n</span></a></span>. 
</div>
<div class="code">
<span class="id" type="keyword">Definition</span> <a name="ultimate_from_nat"><span class="id" type="definition">ultimate_from_nat</span></a> (<span class="id" type="var">n</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a>) (<span class="id" type="var">H</span> : <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Peano.html#:nat_scope:x_'>'_x"><span class="id" type="notation">&gt;</span></a> 0) : <a class="idref" href="Fin.html#fin"><span class="id" type="definition">fin</span></a> <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> (@<a class="idref" href="Fin.html#from_nat"><span class="id" type="definition">from_nat</span></a> <span class="id" type="var">n</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Peano.html#pred"><span class="id" type="definition">pred</span></a> <span class="id" type="var">n</span>)).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Arith.Lt.html#lt_pred_n_n"><span class="id" type="lemma">lt_pred_n_n</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Given a value <span class="inlinecode"><a class="idref" href="Compare.html#x"><span class="id" type="variable">x</span></a></span> of type <span class="inlinecode"><a class="idref" href="Fin.html#fin"><span class="id" type="definition">fin</span></a></span> <span class="inlinecode"><a class="idref" href="Fin.html#FinOrder.n"><span class="id" type="axiom">n</span></a></span>, return the next lower inhabitant <span class="inlinecode"><a class="idref" href="Compare.html#y"><span class="id" type="variable">y</span></a></span>,
    such that y &lt; x.  Returns <span class="inlinecode"><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#None"><span class="id" type="constructor">None</span></a></span> if <span class="inlinecode"><a class="idref" href="Compare.html#x"><span class="id" type="variable">x</span></a></span> <span class="inlinecode">=</span> <span class="inlinecode">0</span>. 
</div>
<div class="code">
<span class="id" type="keyword">Definition</span> <a name="pred_fin"><span class="id" type="definition">pred_fin</span></a> {<span class="id" type="var">n</span>} (<span class="id" type="var">f</span> : <a class="idref" href="Fin.html#fin"><span class="id" type="definition">fin</span></a> <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#option"><span class="id" type="inductive">option</span></a> (<a class="idref" href="Fin.html#fin"><span class="id" type="definition">fin</span></a> <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Vectors.Fin.html#to_nat"><span class="id" type="definition">to_nat</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">f</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">f</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">x</span>. <span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#None"><span class="id" type="constructor">None</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" type="constructor">Some</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Arith.Le.html#le_Sn_le"><span class="id" type="lemma">Le.le_Sn_le</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">l</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> (<a class="idref" href="Fin.html#from_nat"><span class="id" type="definition">from_nat</span></a> <span class="id" type="var">x</span> <span class="id" type="var">l</span>).<br/>
<span class="id" type="keyword">Defined</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="fin_Sn_inv"><span class="id" type="definition">fin_Sn_inv</span></a> {<span class="id" type="var">n</span>:<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a>} (<span class="id" type="var">P</span> : <a class="idref" href="Fin.html#fin"><span class="id" type="definition">fin</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a>) → <span class="id" type="keyword">Type</span>)<br/>
&nbsp;&nbsp;(<span class="id" type="var">PO</span> : <a class="idref" href="Fin.html#P"><span class="id" type="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Vectors.Fin.html#F1"><span class="id" type="constructor">F1</span></a>) (<span class="id" type="var">PS</span> : <span class="id" type="keyword">∀</span> <span class="id" type="var">y</span> : <a class="idref" href="Fin.html#fin"><span class="id" type="definition">fin</span></a> <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a>, <a class="idref" href="Fin.html#P"><span class="id" type="variable">P</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Vectors.Fin.html#FS"><span class="id" type="constructor">FS</span></a> <a class="idref" href="Fin.html#y"><span class="id" type="variable">y</span></a>)) :<br/>
&nbsp;&nbsp;<span class="id" type="keyword">∀</span> <span class="id" type="var">x</span> : <a class="idref" href="Fin.html#fin"><span class="id" type="definition">fin</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a>), <a class="idref" href="Fin.html#P"><span class="id" type="variable">P</span></a> <a class="idref" href="Fin.html#x"><span class="id" type="variable">x</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <a class="idref" href="Fin.html#x"><span class="id" type="variable">x</span></a> <span class="id" type="keyword">in</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Vectors.Fin.html#t"><span class="id" type="inductive">t</span></a> <span class="id" type="var">Sn</span>) <span class="id" type="keyword">return</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">match</span> <a class="idref" href="Fin.html#Sn"><span class="id" type="variable">Sn</span></a> <span class="id" type="keyword">return</span> (<a class="idref" href="Fin.html#fin"><span class="id" type="definition">fin</span></a> <a class="idref" href="Fin.html#Sn"><span class="id" type="variable">Sn</span></a> → <span class="id" type="keyword">Type</span>) <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 0 ⇒ <span class="id" type="keyword">fun</span> <span class="id" type="var">_</span> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#unit"><span class="id" type="inductive">unit</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <span class="id" type="var">n'</span> ⇒ <span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> ⇒ <span class="id" type="keyword">∀</span> (<span class="id" type="var">P</span> : <a class="idref" href="Fin.html#fin"><span class="id" type="definition">fin</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <span class="id" type="var">n'</span>) → <span class="id" type="keyword">Type</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Fin.html#P"><span class="id" type="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Vectors.Fin.html#F1"><span class="id" type="constructor">F1</span></a> → (<span class="id" type="keyword">∀</span> <span class="id" type="var">y</span> : <a class="idref" href="Fin.html#fin"><span class="id" type="definition">fin</span></a> <span class="id" type="var">n'</span>, <a class="idref" href="Fin.html#P"><span class="id" type="variable">P</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Vectors.Fin.html#FS"><span class="id" type="constructor">FS</span></a> <a class="idref" href="Fin.html#y"><span class="id" type="variable">y</span></a>)) →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Fin.html#P"><span class="id" type="variable">P</span></a> <a class="idref" href="Fin.html#x"><span class="id" type="variable">x</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span> <a class="idref" href="Fin.html#x"><span class="id" type="variable">x</span></a>) <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Vectors.Fin.html#F1"><span class="id" type="constructor">F1</span></a> <span class="id" type="var">_</span> ⇒ <span class="id" type="keyword">fun</span> <span class="id" type="var">P</span> <span class="id" type="var">PO</span> <span class="id" type="var">PS</span> ⇒ <a class="idref" href="Fin.html#PO"><span class="id" type="variable">PO</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Vectors.Fin.html#FS"><span class="id" type="constructor">FS</span></a> <span class="id" type="var">_</span> <span class="id" type="var">y</span> ⇒ <span class="id" type="keyword">fun</span> <span class="id" type="var">P</span> <span class="id" type="var">PO</span> <span class="id" type="var">PS</span> ⇒ <a class="idref" href="Fin.html#PS"><span class="id" type="variable">PS</span></a> <span class="id" type="var">y</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span> <a class="idref" href="Fin.html#P"><span class="id" type="variable">P</span></a> <a class="idref" href="Fin.html#PO"><span class="id" type="variable">PO</span></a> <a class="idref" href="Fin.html#PS"><span class="id" type="variable">PS</span></a>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Vectors.Fin.html#to_nat"><span class="id" type="definition">to_nat</span></a></span> and <span class="inlinecode"><a class="idref" href="Fin.html#from_nat"><span class="id" type="definition">from_nat</span></a></span> compose to an identity module the hypothesis that
    <span class="inlinecode"><a class="idref" href="Fin.html#FinOrder.n"><span class="id" type="axiom">n</span></a></span> <span class="inlinecode">&lt;</span> <span class="inlinecode"><a class="idref" href="Fin.html#m"><span class="id" type="variable">m</span></a></span>. 
</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <a name="fin_to_from_id"><span class="id" type="lemma">fin_to_from_id</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">m</span> <span class="id" type="var">n</span> (<span class="id" type="var">H</span> : <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Peano.html#:nat_scope:x_'<'_x"><span class="id" type="notation">&lt;</span></a> <a class="idref" href="Fin.html#m"><span class="id" type="variable">m</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="Fin.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Peano.html#:nat_scope:x_'>'_x"><span class="id" type="notation">&gt;</span></a> 0 → <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Vectors.Fin.html#to_nat"><span class="id" type="definition">to_nat</span></a> (<a class="idref" href="Fin.html#from_nat"><span class="id" type="definition">from_nat</span></a> <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a> <a class="idref" href="Fin.html#H"><span class="id" type="variable">H</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif.html#exist"><span class="id" type="constructor">exist</span></a> <span class="id" type="var">_</span> <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a> <a class="idref" href="Fin.html#H"><span class="id" type="variable">H</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">generalize</span> <span class="id" type="tactic">dependent</span> <span class="id" type="var">n</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">m</span>; <span class="id" type="tactic">intros</span>. <span class="id" type="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">n</span>; <span class="id" type="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">f_equal</span>. <span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Logic.ProofIrrelevance.html#proof_irrelevance"><span class="id" type="axiom">proof_irrelevance</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">IHm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">f_equal</span>. <span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Logic.ProofIrrelevance.html#proof_irrelevance"><span class="id" type="axiom">proof_irrelevance</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">omega</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="FS_inv"><span class="id" type="definition">FS_inv</span></a> {<span class="id" type="var">n</span>} (<span class="id" type="var">x</span> : <a class="idref" href="Fin.html#fin"><span class="id" type="definition">fin</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a>)) : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#option"><span class="id" type="inductive">option</span></a> (<a class="idref" href="Fin.html#fin"><span class="id" type="definition">fin</span></a> <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a>) :=<br/>
&nbsp;&nbsp;<a class="idref" href="Fin.html#fin_Sn_inv"><span class="id" type="definition">fin_Sn_inv</span></a> (<span class="id" type="keyword">fun</span> <span class="id" type="var">_</span> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#option"><span class="id" type="inductive">option</span></a> (<a class="idref" href="Fin.html#fin"><span class="id" type="definition">fin</span></a> <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a>)) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#None"><span class="id" type="constructor">None</span></a> (@<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" type="constructor">Some</span></a> <span class="id" type="var">_</span>) <a class="idref" href="Fin.html#x"><span class="id" type="variable">x</span></a>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="fin_to_nat_Sn"><span class="id" type="lemma">fin_to_nat_Sn</span></a> : <span class="id" type="keyword">∀</span> {<span class="id" type="var">m</span>} (<span class="id" type="var">n</span> : <a class="idref" href="Fin.html#fin"><span class="id" type="definition">fin</span></a> <a class="idref" href="Fin.html#m"><span class="id" type="variable">m</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="Fin.html#fin_to_nat"><span class="id" type="definition">fin_to_nat</span></a> (@<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Vectors.Fin.html#FS"><span class="id" type="constructor">FS</span></a> <a class="idref" href="Fin.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> (<a class="idref" href="Fin.html#fin_to_nat"><span class="id" type="definition">fin_to_nat</span></a> <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span>. <span class="id" type="tactic">unfold</span> <a class="idref" href="Fin.html#fin_to_nat"><span class="id" type="definition">fin_to_nat</span></a>. <span class="id" type="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">induction</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Vectors.Fin.html#to_nat"><span class="id" type="definition">to_nat</span></a> <span class="id" type="var">n</span>); <span class="id" type="tactic">reflexivity</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="fin_from_to_id"><span class="id" type="lemma">fin_from_to_id</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">n</span> (<span class="id" type="var">x</span> : <a class="idref" href="Fin.html#fin"><span class="id" type="definition">fin</span></a> <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">(</span></a><span class="id" type="keyword">let</span> (<span class="id" type="var">m</span>,<span class="id" type="var">H</span>) := <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Vectors.Fin.html#to_nat"><span class="id" type="definition">to_nat</span></a> <a class="idref" href="Fin.html#x"><span class="id" type="variable">x</span></a> <span class="id" type="keyword">in</span> <a class="idref" href="Fin.html#from_nat"><span class="id" type="definition">from_nat</span></a> <a class="idref" href="Fin.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="Fin.html#H"><span class="id" type="variable">H</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Fin.html#x"><span class="id" type="variable">x</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">n</span>; <span class="id" type="tactic">intros</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">x</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">x</span> <span class="id" type="keyword">using</span> <a class="idref" href="Fin.html#fin_Sn_inv"><span class="id" type="definition">fin_Sn_inv</span></a>; <span class="id" type="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">specialize</span> (<span class="id" type="var">IHn</span> <span class="id" type="var">x</span>). <span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Vectors.Fin.html#to_nat"><span class="id" type="definition">to_nat</span></a> <span class="id" type="var">x</span>) <span class="id" type="var">eqn</span>:<span class="id" type="var">Heqe</span>. <span class="id" type="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">l</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Arith.Lt.html#lt_S_n"><span class="id" type="lemma">lt_S_n</span></a> <span class="id" type="var">x0</span> <span class="id" type="var">n</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Arith.Lt.html#lt_n_S"><span class="id" type="lemma">lt_n_S</span></a> <span class="id" type="var">x0</span> <span class="id" type="var">n</span> <span class="id" type="var">l</span>)) <span class="id" type="tactic">by</span> (<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Logic.ProofIrrelevance.html#proof_irrelevance"><span class="id" type="axiom">proof_irrelevance</span></a>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">IHn</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>

<br/>
</div>

<div class="doc">
Given a value of type <span class="inlinecode"><a class="idref" href="Fin.html#fin"><span class="id" type="definition">fin</span></a></span> <span class="inlinecode">(<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a></span> <span class="inlinecode"><a class="idref" href="Fin.html#FinOrder.n"><span class="id" type="axiom">n</span></a>)</span>, return the equivalent <span class="inlinecode"><a class="idref" href="Fin.html#fin"><span class="id" type="definition">fin</span></a></span> <span class="inlinecode"><a class="idref" href="Fin.html#FinOrder.n"><span class="id" type="axiom">n</span></a></span>,
    returning None if the input value was the highest possible value of <span class="inlinecode"><a class="idref" href="Fin.html#fin"><span class="id" type="definition">fin</span></a></span>
    <span class="inlinecode">(<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a></span> <span class="inlinecode"><a class="idref" href="Fin.html#FinOrder.n"><span class="id" type="axiom">n</span></a>)</span>. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Definition</span> <a name="fin_reduce"><span class="id" type="definition">fin_reduce</span></a> {<span class="id" type="var">n</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a>} (<span class="id" type="var">x</span> : <a class="idref" href="Fin.html#fin"><span class="id" type="definition">fin</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a>)) : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#option"><span class="id" type="inductive">option</span></a> (<a class="idref" href="Fin.html#fin"><span class="id" type="definition">fin</span></a> <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">n'</span> := <a class="idref" href="Fin.html#fin_to_nat"><span class="id" type="definition">fin_to_nat</span></a> <a class="idref" href="Fin.html#x"><span class="id" type="variable">x</span></a> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Arith.Compare_dec.html#le_lt_dec"><span class="id" type="definition">le_lt_dec</span></a> <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a> <a class="idref" href="Fin.html#n'"><span class="id" type="variable">n'</span></a> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif.html#right"><span class="id" type="constructor">right</span></a> <span class="id" type="var">H</span> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" type="constructor">Some</span></a> (<a class="idref" href="Fin.html#from_nat"><span class="id" type="definition">from_nat</span></a> <a class="idref" href="Fin.html#n'"><span class="id" type="variable">n'</span></a> <span class="id" type="var">H</span>)<br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif.html#left"><span class="id" type="constructor">left</span></a> <span class="id" type="var">_</span>  ⇒ <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#None"><span class="id" type="constructor">None</span></a><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
The behavior of <span class="inlinecode"><a class="idref" href="Fin.html#pred_fin"><span class="id" type="definition">pred_fin</span></a></span> is specified as follows: the predecessor of a
    successor, by way of <span class="inlinecode"><a class="idref" href="Fin.html#fin"><span class="id" type="definition">fin</span></a></span> <span class="inlinecode"><a class="idref" href="Fin.html#FinOrder.n"><span class="id" type="axiom">n</span></a></span>, is a no-op. 
</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <a name="pred_fin_spec"><span class="id" type="lemma">pred_fin_spec</span></a> : <span class="id" type="keyword">∀</span> (<span class="id" type="var">n</span> <span class="id" type="var">m</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a>) (<span class="id" type="var">H</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Peano.html#:nat_scope:x_'<'_x"><span class="id" type="notation">&lt;</span></a> <a class="idref" href="Fin.html#m"><span class="id" type="variable">m</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="Fin.html#pred_fin"><span class="id" type="definition">pred_fin</span></a> (@<a class="idref" href="Fin.html#from_nat"><span class="id" type="definition">from_nat</span></a> <a class="idref" href="Fin.html#m"><span class="id" type="variable">m</span></a> <span class="id" type="var">_</span> <a class="idref" href="Fin.html#H"><span class="id" type="variable">H</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" type="constructor">Some</span></a> (<a class="idref" href="Fin.html#from_nat"><span class="id" type="definition">from_nat</span></a> <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Arith.Le.html#le_Sn_le"><span class="id" type="lemma">Le.le_Sn_le</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <a class="idref" href="Fin.html#H"><span class="id" type="variable">H</span></a>)).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span>. <span class="id" type="tactic">unfold</span> <a class="idref" href="Fin.html#pred_fin"><span class="id" type="definition">pred_fin</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="Fin.html#fin_to_from_id"><span class="id" type="lemma">fin_to_from_id</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">omega</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
If <span class="inlinecode"><a class="idref" href="Fin.html#pred_fin"><span class="id" type="definition">pred_fin</span></a></span> produces a value, this value converted to <span class="inlinecode"><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a></span> is less than
    the input converted to <span class="inlinecode"><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a></span>. 
</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <a name="pred_fin_lt"><span class="id" type="lemma">pred_fin_lt</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">n</span> (<span class="id" type="var">x</span> <span class="id" type="var">y</span> : <a class="idref" href="Fin.html#fin"><span class="id" type="definition">fin</span></a> <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a>),<br/>
&nbsp;&nbsp;@<a class="idref" href="Fin.html#pred_fin"><span class="id" type="definition">pred_fin</span></a> <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a> <a class="idref" href="Fin.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" type="constructor">Some</span></a> <a class="idref" href="Fin.html#y"><span class="id" type="variable">y</span></a> → <a class="idref" href="Fin.html#fin_to_nat"><span class="id" type="definition">fin_to_nat</span></a> <a class="idref" href="Fin.html#y"><span class="id" type="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Peano.html#:nat_scope:x_'<'_x"><span class="id" type="notation">&lt;</span></a> <a class="idref" href="Fin.html#fin_to_nat"><span class="id" type="definition">fin_to_nat</span></a> <a class="idref" href="Fin.html#x"><span class="id" type="variable">x</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <a class="idref" href="Fin.html#fin_to_nat"><span class="id" type="definition">fin_to_nat</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">n</span>; <span class="id" type="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">inversion</span> <span class="id" type="var">x</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <a class="idref" href="Fin.html#pred_fin"><span class="id" type="definition">pred_fin</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Vectors.Fin.html#to_nat"><span class="id" type="definition">to_nat</span></a> <span class="id" type="var">x</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">x0</span>; <span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">subst</span>. <span class="id" type="tactic">simpl</span>. <span class="id" type="tactic">clear</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">x0</span>; <span class="id" type="tactic">simpl</span>. <span class="id" type="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="Fin.html#fin_to_from_id"><span class="id" type="lemma">fin_to_from_id</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>. <span class="id" type="tactic">omega</span>. <span class="id" type="tactic">omega</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
The function <span class="inlinecode"><a class="idref" href="Fin.html#fin_to_nat"><span class="id" type="definition">fin_to_nat</span></a></span> is bijective. 
</div>
<div class="code">
<span class="id" type="keyword">Lemma</span> <a name="fin_to_nat_bijective"><span class="id" type="lemma">fin_to_nat_bijective</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">n</span> (<span class="id" type="var">x</span> <span class="id" type="var">y</span> : <a class="idref" href="Fin.html#fin"><span class="id" type="definition">fin</span></a> <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="Fin.html#fin_to_nat"><span class="id" type="definition">fin_to_nat</span></a> <a class="idref" href="Fin.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Fin.html#fin_to_nat"><span class="id" type="definition">fin_to_nat</span></a> <a class="idref" href="Fin.html#y"><span class="id" type="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'<->'_x"><span class="id" type="notation">↔</span></a> <a class="idref" href="Fin.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Fin.html#y"><span class="id" type="variable">y</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <a class="idref" href="Fin.html#fin_to_nat"><span class="id" type="definition">fin_to_nat</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">split</span>; <span class="id" type="tactic">intros</span>.<br/>
&nbsp;&nbsp;- <span class="id" type="tactic">destruct</span> <span class="id" type="var">n</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">generalize</span> <span class="id" type="tactic">dependent</span> <span class="id" type="var">y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">x</span>; <span class="id" type="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">dependent</span> <span class="id" type="tactic">destruction</span> <span class="id" type="var">y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Vectors.Fin.html#to_nat"><span class="id" type="definition">to_nat</span></a> <span class="id" type="var">y</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">dependent</span> <span class="id" type="tactic">destruction</span> <span class="id" type="var">y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Vectors.Fin.html#to_nat"><span class="id" type="definition">to_nat</span></a> <span class="id" type="var">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">specialize</span> (<span class="id" type="var">IHx</span> <span class="id" type="var">y</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">f_equal</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">IHx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Vectors.Fin.html#to_nat"><span class="id" type="definition">to_nat</span></a> <span class="id" type="var">x</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Vectors.Fin.html#to_nat"><span class="id" type="definition">to_nat</span></a> <span class="id" type="var">y</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Peano.html#eq_add_S"><span class="id" type="definition">eq_add_S</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">subst</span>. <span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" type="tactic">f_equal</span>. <span class="id" type="tactic">f_equal</span>. <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Fixpoint</span> <a name="catMaybes"><span class="id" type="definition">catMaybes</span></a> {<span class="id" type="var">a</span> : <span class="id" type="keyword">Set</span>} (<span class="id" type="var">l</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#list"><span class="id" type="inductive">list</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#option"><span class="id" type="inductive">option</span></a> <a class="idref" href="Fin.html#a"><span class="id" type="variable">a</span></a>)) : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#list"><span class="id" type="inductive">list</span></a> <a class="idref" href="Fin.html#a"><span class="id" type="variable">a</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <a class="idref" href="Fin.html#l"><span class="id" type="variable">l</span></a> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#nil"><span class="id" type="constructor">nil</span></a> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#nil"><span class="id" type="constructor">nil</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#cons"><span class="id" type="constructor">cons</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#None"><span class="id" type="constructor">None</span></a> <span class="id" type="var">xs</span> ⇒ <a class="idref" href="Fin.html#catMaybes"><span class="id" type="definition">catMaybes</span></a> <span class="id" type="var">xs</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#cons"><span class="id" type="constructor">cons</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#Some"><span class="id" type="constructor">Some</span></a> <span class="id" type="var">x</span>) <span class="id" type="var">xs</span> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#cons"><span class="id" type="constructor">cons</span></a> <span class="id" type="var">x</span> (<a class="idref" href="Fin.html#catMaybes"><span class="id" type="definition">catMaybes</span></a> <span class="id" type="var">xs</span>)<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="map_FS_inv"><span class="id" type="definition">map_FS_inv</span></a> {<span class="id" type="var">n</span>:<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a>} (<span class="id" type="var">l</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#list"><span class="id" type="inductive">list</span></a> (<a class="idref" href="Fin.html#fin"><span class="id" type="definition">fin</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a>))) : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#list"><span class="id" type="inductive">list</span></a> (<a class="idref" href="Fin.html#fin"><span class="id" type="definition">fin</span></a> <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a>) :=<br/>
&nbsp;&nbsp;<a class="idref" href="Fin.html#catMaybes"><span class="id" type="definition">catMaybes</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Lists.List.html#map"><span class="id" type="definition">map</span></a> <a class="idref" href="Fin.html#FS_inv"><span class="id" type="definition">FS_inv</span></a> <a class="idref" href="Fin.html#l"><span class="id" type="variable">l</span></a>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="map_FS_inv_len_noO"><span class="id" type="lemma">map_FS_inv_len_noO</span></a> : <span class="id" type="keyword">∀</span> {<span class="id" type="var">n</span>} (<span class="id" type="var">l</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#list"><span class="id" type="inductive">list</span></a> (<a class="idref" href="Fin.html#fin"><span class="id" type="definition">fin</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a>))),<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:'~'_x"><span class="id" type="notation">¬</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Lists.List.html#In"><span class="id" type="definition">In</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Vectors.Fin.html#F1"><span class="id" type="constructor">F1</span></a> <a class="idref" href="Fin.html#l"><span class="id" type="variable">l</span></a> → <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#length"><span class="id" type="definition">length</span></a> (<a class="idref" href="Fin.html#map_FS_inv"><span class="id" type="definition">map_FS_inv</span></a> <a class="idref" href="Fin.html#l"><span class="id" type="variable">l</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#length"><span class="id" type="definition">length</span></a> <a class="idref" href="Fin.html#l"><span class="id" type="variable">l</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">l</span>; <span class="id" type="tactic">simpl</span>. <span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">a</span> <span class="id" type="keyword">using</span> <a class="idref" href="Fin.html#fin_Sn_inv"><span class="id" type="definition">fin_Sn_inv</span></a>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">intuition</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="map_FS_inv_len_NoDup"><span class="id" type="lemma">map_FS_inv_len_NoDup</span></a> : <span class="id" type="keyword">∀</span> {<span class="id" type="var">n</span>} (<span class="id" type="var">l</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#list"><span class="id" type="inductive">list</span></a> (<a class="idref" href="Fin.html#fin"><span class="id" type="definition">fin</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a>))),<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Lists.List.html#NoDup"><span class="id" type="inductive">NoDup</span></a> <a class="idref" href="Fin.html#l"><span class="id" type="variable">l</span></a> → <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#length"><span class="id" type="definition">length</span></a> <a class="idref" href="Fin.html#l"><span class="id" type="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Peano.html#:nat_scope:x_'<='_x"><span class="id" type="notation">≤</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#length"><span class="id" type="definition">length</span></a> (<a class="idref" href="Fin.html#map_FS_inv"><span class="id" type="definition">map_FS_inv</span></a> <a class="idref" href="Fin.html#l"><span class="id" type="variable">l</span></a>)).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">induction</span> 1; <span class="id" type="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Arith.Le.html#le_0_n"><span class="id" type="lemma">le_0_n</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <a class="idref" href="Fin.html#map_FS_inv"><span class="id" type="definition">map_FS_inv</span></a>, <a class="idref" href="Fin.html#catMaybes"><span class="id" type="definition">catMaybes</span></a>. <span class="id" type="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">x</span> <span class="id" type="keyword">using</span> <a class="idref" href="Fin.html#fin_Sn_inv"><span class="id" type="definition">fin_Sn_inv</span></a>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">fold</span> (@<a class="idref" href="Fin.html#catMaybes"><span class="id" type="definition">catMaybes</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">pose</span> (<a class="idref" href="Fin.html#map_FS_inv_len_noO"><span class="id" type="lemma">map_FS_inv_len_noO</span></a> <span class="id" type="var">l</span> <span class="id" type="var">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <a class="idref" href="Fin.html#map_FS_inv"><span class="id" type="definition">map_FS_inv</span></a> <span class="id" type="keyword">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">e</span>. <span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> <span class="id" type="var">arith</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="in_map_FS_inv"><span class="id" type="lemma">in_map_FS_inv</span></a> : <span class="id" type="keyword">∀</span> {<span class="id" type="var">n</span>} (<span class="id" type="var">l</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#list"><span class="id" type="inductive">list</span></a> (<a class="idref" href="Fin.html#fin"><span class="id" type="definition">fin</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a>))) (<span class="id" type="var">y</span> : <a class="idref" href="Fin.html#fin"><span class="id" type="definition">fin</span></a> <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Lists.List.html#In"><span class="id" type="definition">In</span></a> <a class="idref" href="Fin.html#y"><span class="id" type="variable">y</span></a> (<a class="idref" href="Fin.html#map_FS_inv"><span class="id" type="definition">map_FS_inv</span></a> <a class="idref" href="Fin.html#l"><span class="id" type="variable">l</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'<->'_x"><span class="id" type="notation">↔</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Lists.List.html#In"><span class="id" type="definition">In</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Vectors.Fin.html#FS"><span class="id" type="constructor">FS</span></a> <a class="idref" href="Fin.html#y"><span class="id" type="variable">y</span></a>) <a class="idref" href="Fin.html#l"><span class="id" type="variable">l</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">l</span>; <span class="id" type="tactic">simpl</span>. <span class="id" type="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">a</span> <span class="id" type="keyword">using</span> <a class="idref" href="Fin.html#fin_Sn_inv"><span class="id" type="definition">fin_Sn_inv</span></a>; <span class="id" type="tactic">simpl</span>. <span class="id" type="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> 1. <span class="id" type="tactic">left</span>; <span class="id" type="tactic">f_equal</span>; <span class="id" type="tactic">trivial</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">right</span>; <span class="id" type="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">l</span>; <span class="id" type="tactic">simpl</span>. <span class="id" type="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">a</span> <span class="id" type="keyword">using</span> <a class="idref" href="Fin.html#fin_Sn_inv"><span class="id" type="definition">fin_Sn_inv</span></a>; <span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <a class="idref" href="Fin.html#map_FS_inv"><span class="id" type="definition">map_FS_inv</span></a>. <span class="id" type="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">IHl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intuition</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">H0</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">left</span>. <span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Vectors.Fin.html#FS_inj"><span class="id" type="definition">FS_inj</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">H0</span>. <span class="id" type="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">right</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">IHl</span>. <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="map_FS_inv_NoDup"><span class="id" type="lemma">map_FS_inv_NoDup</span></a> : <span class="id" type="keyword">∀</span> {<span class="id" type="var">n</span>:<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a>} (<span class="id" type="var">l</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#list"><span class="id" type="inductive">list</span></a> (<a class="idref" href="Fin.html#fin"><span class="id" type="definition">fin</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a>))),<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Lists.List.html#NoDup"><span class="id" type="inductive">NoDup</span></a> <a class="idref" href="Fin.html#l"><span class="id" type="variable">l</span></a> → <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Lists.List.html#NoDup"><span class="id" type="inductive">NoDup</span></a> (<a class="idref" href="Fin.html#map_FS_inv"><span class="id" type="definition">map_FS_inv</span></a> <a class="idref" href="Fin.html#l"><span class="id" type="variable">l</span></a>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">induction</span> 1; <span class="id" type="tactic">simpl</span>. <span class="id" type="tactic">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">x</span> <span class="id" type="keyword">using</span> <a class="idref" href="Fin.html#fin_Sn_inv"><span class="id" type="definition">fin_Sn_inv</span></a>; <span class="id" type="tactic">simpl</span>. <span class="id" type="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">constructor</span>; <span class="id" type="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id" type="var">contradict</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Fin.html#in_map_FS_inv"><span class="id" type="lemma">in_map_FS_inv</span></a>; <span class="id" type="tactic">trivial</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Theorem</span> <a name="fin_list"><span class="id" type="lemma">fin_list</span></a> <span class="id" type="var">n</span> (<span class="id" type="var">l</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#list"><span class="id" type="inductive">list</span></a> (<a class="idref" href="Fin.html#fin"><span class="id" type="definition">fin</span></a> <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a>)) : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Lists.List.html#NoDup"><span class="id" type="inductive">NoDup</span></a> <a class="idref" href="Fin.html#l"><span class="id" type="variable">l</span></a> → <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#length"><span class="id" type="definition">length</span></a> <a class="idref" href="Fin.html#l"><span class="id" type="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Peano.html#:nat_scope:x_'<='_x"><span class="id" type="notation">≤</span></a> <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">n</span> <span class="id" type="keyword">as</span> [|<span class="id" type="var">n'</span>]; <span class="id" type="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">l</span> <span class="id" type="keyword">as</span> [|<span class="id" type="var">hd</span> ?]; <span class="id" type="tactic">trivial</span>; <span class="id" type="tactic">inversion</span> <span class="id" type="var">hd</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Arith.Le.html#le_trans"><span class="id" type="lemma">le_trans</span></a> <span class="id" type="keyword">with</span> (1 := <a class="idref" href="Fin.html#map_FS_inv_len_NoDup"><span class="id" type="lemma">map_FS_inv_len_NoDup</span></a> <span class="id" type="var">l</span> <span class="id" type="var">H</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">auto</span> <span class="id" type="keyword">using</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Arith.Le.html#le_n_S"><span class="id" type="lemma">le_n_S</span></a>, <a class="idref" href="Fin.html#map_FS_inv_NoDup"><span class="id" type="lemma">map_FS_inv_NoDup</span></a>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab3"></a><h3 class="section">Comparison of values from the same finite set.</h3>

<div class="paragraph"> </div>

 <span class="inlinecode"><a class="idref" href="Fin.html#fin"><span class="id" type="definition">fin</span></a></span> values may be compared.  It is simply a comparison of their
    underlying naturals, owing to proof irrelevance. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Definition</span> <a name="fin_compare"><span class="id" type="definition">fin_compare</span></a> {<span class="id" type="var">n</span>} (<span class="id" type="var">x</span> <span class="id" type="var">y</span> : <a class="idref" href="Fin.html#fin"><span class="id" type="definition">fin</span></a> <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#comparison"><span class="id" type="inductive">comparison</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Arith.Compare_dec.html#nat_compare"><span class="id" type="definition">nat_compare</span></a> (<a class="idref" href="Fin.html#fin_to_nat"><span class="id" type="definition">fin_to_nat</span></a> <a class="idref" href="Fin.html#x"><span class="id" type="variable">x</span></a>) (<a class="idref" href="Fin.html#fin_to_nat"><span class="id" type="definition">fin_to_nat</span></a> <a class="idref" href="Fin.html#y"><span class="id" type="variable">y</span></a>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="fin_compare_eq_iff"><span class="id" type="lemma">fin_compare_eq_iff</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">n</span> (<span class="id" type="var">x</span> <span class="id" type="var">y</span> : <a class="idref" href="Fin.html#fin"><span class="id" type="definition">fin</span></a> <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="Fin.html#fin_compare"><span class="id" type="definition">fin_compare</span></a> <a class="idref" href="Fin.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Fin.html#y"><span class="id" type="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#Eq"><span class="id" type="constructor">Eq</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'<->'_x"><span class="id" type="notation">↔</span></a> <a class="idref" href="Fin.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Fin.html#y"><span class="id" type="variable">y</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <a class="idref" href="Fin.html#fin_compare"><span class="id" type="definition">fin_compare</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">split</span>; <span class="id" type="tactic">intros</span>;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">first</span> [ <span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Arith.Compare_dec.html#nat_compare_eq_iff"><span class="id" type="lemma">nat_compare_eq_iff</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Arith.Compare_dec.html#nat_compare_eq"><span class="id" type="lemma">nat_compare_eq</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span> ];<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Fin.html#fin_to_nat_bijective"><span class="id" type="lemma">fin_to_nat_bijective</span></a>; <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="fin_compare_gt_flip"><span class="id" type="lemma">fin_compare_gt_flip</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">n</span> (<span class="id" type="var">x</span> <span class="id" type="var">y</span> : <a class="idref" href="Fin.html#fin"><span class="id" type="definition">fin</span></a> <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="Fin.html#fin_compare"><span class="id" type="definition">fin_compare</span></a> <a class="idref" href="Fin.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Fin.html#y"><span class="id" type="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#Gt"><span class="id" type="constructor">Gt</span></a> → <a class="idref" href="Fin.html#fin_compare"><span class="id" type="definition">fin_compare</span></a> <a class="idref" href="Fin.html#y"><span class="id" type="variable">y</span></a> <a class="idref" href="Fin.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#Lt"><span class="id" type="constructor">Lt</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <a class="idref" href="Fin.html#fin_compare"><span class="id" type="definition">fin_compare</span></a>. <span class="id" type="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Arith.Compare_dec.html#nat_compare_gt"><span class="id" type="lemma">nat_compare_gt</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Arith.Compare_dec.html#nat_compare_lt"><span class="id" type="lemma">nat_compare_lt</span></a>. <span class="id" type="tactic">omega</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Program Instance</span> <a name="fin_CompareSpec"><span class="id" type="instance">fin_CompareSpec</span></a> {<span class="id" type="var">n</span>} : <a class="idref" href="Compare.html#CompareSpec"><span class="id" type="class">CompareSpec</span></a> (<a class="idref" href="Fin.html#fin"><span class="id" type="definition">fin</span></a> <span class="id" type="var">n</span>) := {<br/>
&nbsp;&nbsp;<a class="idref" href="Compare.html#cmp"><span class="id" type="method">cmp</span></a>         := <a class="idref" href="Fin.html#fin_compare"><span class="id" type="definition">fin_compare</span></a>;<br/>
&nbsp;&nbsp;<a class="idref" href="Compare.html#cmp_eq_iff"><span class="id" type="method">cmp_eq_iff</span></a>  := <a class="idref" href="Fin.html#fin_compare_eq_iff"><span class="id" type="lemma">fin_compare_eq_iff</span></a> <span class="id" type="var">n</span>;<br/>
&nbsp;&nbsp;<a class="idref" href="Compare.html#cmp_gt_flip"><span class="id" type="method">cmp_gt_flip</span></a> := <a class="idref" href="Fin.html#fin_compare_gt_flip"><span class="id" type="lemma">fin_compare_gt_flip</span></a> <span class="id" type="var">n</span><br/>
}.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="is_le"><span class="id" type="definition">is_le</span></a> (<span class="id" type="var">c</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#comparison"><span class="id" type="inductive">comparison</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#bool"><span class="id" type="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <a class="idref" href="Fin.html#c"><span class="id" type="variable">c</span></a> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#Gt"><span class="id" type="constructor">Gt</span></a> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#false"><span class="id" type="constructor">false</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span>  ⇒ <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#true"><span class="id" type="constructor">true</span></a><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Module</span> <a name="FinOrder"><span class="id" type="module">FinOrder</span></a> &lt;: <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Structures.Orders.html#"><span class="id" type="module">TotalTransitiveLeBool</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Parameter</span> <a name="FinOrder.n"><span class="id" type="axiom">n</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="FinOrder.t"><span class="id" type="definition">t</span></a> := <a class="idref" href="Fin.html#FinOrder.fin"><span class="id" type="definition">fin</span></a> <a class="idref" href="Fin.html#FinOrder.n"><span class="id" type="axiom">n</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="FinOrder.leb"><span class="id" type="definition">leb</span></a> (<span class="id" type="var">x</span> <span class="id" type="var">y</span> : <a class="idref" href="Fin.html#FinOrder.fin"><span class="id" type="definition">fin</span></a> <a class="idref" href="Fin.html#FinOrder.n"><span class="id" type="axiom">n</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#bool"><span class="id" type="inductive">bool</span></a> := <a class="idref" href="Fin.html#FinOrder.is_le"><span class="id" type="definition">is_le</span></a> (<a class="idref" href="Compare.html#cmp"><span class="id" type="method">cmp</span></a> <a class="idref" href="Fin.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Fin.html#y"><span class="id" type="variable">y</span></a>).<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Definition</span> <a name="FinOrder.le"><span class="id" type="definition">le</span></a> (<span class="id" type="var">x</span> <span class="id" type="var">y</span> : <a class="idref" href="Fin.html#FinOrder.fin"><span class="id" type="definition">fin</span></a> <a class="idref" href="Fin.html#FinOrder.n"><span class="id" type="axiom">n</span></a>) := <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#is_true"><span class="id" type="definition">is_true</span></a> (<a class="idref" href="Fin.html#FinOrder.leb"><span class="id" type="definition">leb</span></a> <a class="idref" href="Fin.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Fin.html#y"><span class="id" type="variable">y</span></a>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Theorem</span> <a name="FinOrder.leb_total"><span class="id" type="lemma">leb_total</span></a> : <span class="id" type="keyword">∀</span> (<span class="id" type="var">a1</span> <span class="id" type="var">a2</span> : <a class="idref" href="Fin.html#FinOrder.fin"><span class="id" type="definition">fin</span></a> <a class="idref" href="Fin.html#FinOrder.n"><span class="id" type="axiom">n</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Fin.html#FinOrder.leb"><span class="id" type="definition">leb</span></a> <a class="idref" href="Fin.html#a1"><span class="id" type="variable">a1</span></a> <a class="idref" href="Fin.html#a2"><span class="id" type="variable">a2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#true"><span class="id" type="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'\/'_x"><span class="id" type="notation">∨</span></a> <a class="idref" href="Fin.html#FinOrder.leb"><span class="id" type="definition">leb</span></a> <a class="idref" href="Fin.html#a2"><span class="id" type="variable">a2</span></a> <a class="idref" href="Fin.html#a1"><span class="id" type="variable">a1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#true"><span class="id" type="constructor">true</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span>. <span class="id" type="tactic">unfold</span> <a class="idref" href="Fin.html#FinOrder.leb"><span class="id" type="definition">leb</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> (<a class="idref" href="Compare.html#cmp"><span class="id" type="method">cmp</span></a> <span class="id" type="var">a1</span> <span class="id" type="var">a2</span>) <span class="id" type="var">eqn</span>:<span class="id" type="var">Heqe</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" type="tactic">left</span>. <span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" type="tactic">left</span>. <span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" type="tactic">right</span>. <span class="id" type="tactic">apply</span> <a class="idref" href="Compare.html#cmp_gt_flip"><span class="id" type="method">cmp_gt_flip</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Heqe</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">Heqe</span>. <span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Theorem</span> <a name="FinOrder.leb_trans"><span class="id" type="lemma">leb_trans</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Classes.RelationClasses.html#Transitive"><span class="id" type="class">Transitive</span></a> <a class="idref" href="Fin.html#FinOrder.le"><span class="id" type="definition">le</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Classes.RelationClasses.html#Transitive"><span class="id" type="class">Transitive</span></a>. <span class="id" type="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <a class="idref" href="Fin.html#FinOrder.le"><span class="id" type="definition">le</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#is_true"><span class="id" type="definition">is_true</span></a>, <a class="idref" href="Fin.html#FinOrder.leb"><span class="id" type="definition">leb</span></a>, <a class="idref" href="Fin.html#FinOrder.is_le"><span class="id" type="definition">is_le</span></a>, <a class="idref" href="Compare.html#cmp"><span class="id" type="method">cmp</span></a> <span class="id" type="keyword">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <a class="idref" href="Fin.html#FinOrder.n"><span class="id" type="axiom">n</span></a>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">x</span> <span class="id" type="keyword">using</span> <a class="idref" href="Fin.html#FinOrder.fin_Sn_inv"><span class="id" type="definition">fin_Sn_inv</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">y</span> <span class="id" type="keyword">using</span> <a class="idref" href="Fin.html#FinOrder.fin_Sn_inv"><span class="id" type="definition">fin_Sn_inv</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">z</span> <span class="id" type="keyword">using</span> <a class="idref" href="Fin.html#FinOrder.fin_Sn_inv"><span class="id" type="definition">fin_Sn_inv</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> *; <span class="id" type="tactic">unfold</span> <a class="idref" href="Fin.html#FinOrder.fin_compare"><span class="id" type="definition">fin_compare</span></a> <span class="id" type="keyword">in</span> *;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> *; <span class="id" type="tactic">auto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="tactic">rewrite</span> <a class="idref" href="Fin.html#FinOrder.fin_to_nat_Sn"><span class="id" type="lemma">fin_to_nat_Sn</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" type="tactic">rewrite</span> <a class="idref" href="Fin.html#FinOrder.fin_to_nat_Sn"><span class="id" type="lemma">fin_to_nat_Sn</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" type="tactic">rewrite</span> <a class="idref" href="Fin.html#FinOrder.fin_to_nat_Sn"><span class="id" type="lemma">fin_to_nat_Sn</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H0</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" type="tactic">apply</span> (<span class="id" type="var">IHn0</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">z</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="tactic">rewrite</span> <a class="idref" href="Fin.html#FinOrder.fin_to_nat_Sn"><span class="id" type="lemma">fin_to_nat_Sn</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="tactic">rewrite</span> <a class="idref" href="Fin.html#FinOrder.fin_to_nat_Sn"><span class="id" type="lemma">fin_to_nat_Sn</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">H0</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">End</span> <a class="idref" href="Fin.html#"><span class="id" type="module">FinOrder</span></a>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="fin_safe_reduce"><span class="id" type="definition">fin_safe_reduce</span></a> {<span class="id" type="var">n</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a>} (<span class="id" type="var">x</span> : <a class="idref" href="Fin.html#fin"><span class="id" type="definition">fin</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a>))<br/>
&nbsp;&nbsp;(<span class="id" type="var">H</span> : <a class="idref" href="Fin.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'<>'_x"><span class="id" type="notation">≠</span></a> <a class="idref" href="Fin.html#last_fin_from_nat"><span class="id" type="definition">last_fin_from_nat</span></a> <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a>) : <a class="idref" href="Fin.html#fin"><span class="id" type="definition">fin</span></a> <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">n</span>; <span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> *;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">x</span> <span class="id" type="keyword">using</span> <a class="idref" href="Fin.html#fin_Sn_inv"><span class="id" type="definition">fin_Sn_inv</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" type="var">contradiction</span> <span class="id" type="var">H</span>. <span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" type="tactic">apply</span> <span class="id" type="var">x</span>.<br/>
&nbsp;&nbsp;- <span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Vectors.Fin.html#F1"><span class="id" type="constructor">F1</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" type="tactic">apply</span> <span class="id" type="var">x</span>.<br/>
<span class="id" type="keyword">Defined</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="last_fin_from_nat_spec"><span class="id" type="lemma">last_fin_from_nat_spec</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">n</span>, <a class="idref" href="Fin.html#fin_to_nat"><span class="id" type="definition">fin_to_nat</span></a> (<a class="idref" href="Fin.html#last_fin_from_nat"><span class="id" type="definition">last_fin_from_nat</span></a> <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">n</span>. <span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <a class="idref" href="Fin.html#last_fin_from_nat"><span class="id" type="definition">last_fin_from_nat</span></a>, <a class="idref" href="Fin.html#fin_to_nat"><span class="id" type="definition">fin_to_nat</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="Fin.html#fin_to_from_id"><span class="id" type="lemma">fin_to_from_id</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Arith.Gt.html#gt_Sn_O"><span class="id" type="lemma">gt_Sn_O</span></a>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="fin_lt"><span class="id" type="lemma">fin_lt</span></a> {<span class="id" type="var">n</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a>} (<span class="id" type="var">l</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#list"><span class="id" type="inductive">list</span></a> (<a class="idref" href="Fin.html#fin"><span class="id" type="definition">fin</span></a> <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a>)) : <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span>, <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Lists.List.html#In"><span class="id" type="definition">In</span></a> <a class="idref" href="Fin.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Fin.html#l"><span class="id" type="variable">l</span></a> → <a class="idref" href="Fin.html#fin_to_nat"><span class="id" type="definition">fin_to_nat</span></a> <a class="idref" href="Fin.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Peano.html#:nat_scope:x_'<'_x"><span class="id" type="notation">&lt;</span></a> <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">n</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">x</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">x</span> <span class="id" type="keyword">using</span> <a class="idref" href="Fin.html#fin_Sn_inv"><span class="id" type="definition">fin_Sn_inv</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <a class="idref" href="Fin.html#fin_to_nat"><span class="id" type="definition">fin_to_nat</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Specif.html#proj1_sig"><span class="id" type="definition">proj1_sig</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Vectors.Fin.html#to_nat"><span class="id" type="definition">to_nat</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Arith.Lt.html#lt_0_Sn"><span class="id" type="lemma">lt_0_Sn</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="Fin.html#fin_to_nat_Sn"><span class="id" type="lemma">fin_to_nat_Sn</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Arith.Lt.html#lt_n_S"><span class="id" type="lemma">lt_n_S</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> (<span class="id" type="var">IHn</span> (<a class="idref" href="Fin.html#map_FS_inv"><span class="id" type="definition">map_FS_inv</span></a> <span class="id" type="var">l</span>)).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Fin.html#in_map_FS_inv"><span class="id" type="lemma">in_map_FS_inv</span></a>. <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="fin_expand"><span class="id" type="definition">fin_expand</span></a> {<span class="id" type="var">n</span>} (<span class="id" type="var">p</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Vectors.Fin.html#t"><span class="id" type="inductive">t</span></a> <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Vectors.Fin.html#t"><span class="id" type="inductive">t</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">n</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">p</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">p</span> <span class="id" type="keyword">using</span> <a class="idref" href="Fin.html#fin_Sn_inv"><span class="id" type="definition">fin_Sn_inv</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Vectors.Fin.html#F1"><span class="id" type="constructor">F1</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Vectors.Fin.html#FS"><span class="id" type="constructor">FS</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">IHn</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">y</span>.<br/>
<span class="id" type="keyword">Defined</span>.<br/>

<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="fin_bounded"><span class="id" type="lemma">fin_bounded</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">m</span> (<span class="id" type="var">n</span> : <a class="idref" href="Fin.html#fin"><span class="id" type="definition">fin</span></a> <a class="idref" href="Fin.html#m"><span class="id" type="variable">m</span></a>), <a class="idref" href="Fin.html#fin_expand"><span class="id" type="definition">fin_expand</span></a> <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'<>'_x"><span class="id" type="notation">≠</span></a> <a class="idref" href="Fin.html#last_fin_from_nat"><span class="id" type="definition">last_fin_from_nat</span></a> <a class="idref" href="Fin.html#m"><span class="id" type="variable">m</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">m</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">n</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">n</span> <span class="id" type="keyword">using</span> <a class="idref" href="Fin.html#fin_Sn_inv"><span class="id" type="definition">fin_Sn_inv</span></a>; <span class="id" type="tactic">intuition</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> (<span class="id" type="var">IHm</span> <span class="id" type="var">n</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <a class="idref" href="Fin.html#last_fin_from_nat"><span class="id" type="definition">last_fin_from_nat</span></a> <span class="id" type="keyword">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> ×.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Vectors.Fin.html#FS_inj"><span class="id" type="definition">FS_inj</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">H</span>. <span class="id" type="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Logic.ProofIrrelevance.html#proof_irrelevance"><span class="id" type="axiom">proof_irrelevance</span></a>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="last_fin_from_nat_not_In"><span class="id" type="lemma">last_fin_from_nat_not_In</span></a> {<span class="id" type="var">n</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a>} (<span class="id" type="var">l</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#list"><span class="id" type="inductive">list</span></a> (<a class="idref" href="Fin.html#fin"><span class="id" type="definition">fin</span></a> <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a>))<br/>
&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:'~'_x"><span class="id" type="notation">¬</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Lists.List.html#In"><span class="id" type="definition">In</span></a> (<a class="idref" href="Fin.html#last_fin_from_nat"><span class="id" type="definition">last_fin_from_nat</span></a> <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a>) (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Lists.List.html#map"><span class="id" type="definition">map</span></a> <a class="idref" href="Fin.html#fin_expand"><span class="id" type="definition">fin_expand</span></a> <a class="idref" href="Fin.html#l"><span class="id" type="variable">l</span></a>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">l</span>; <span class="id" type="tactic">simpl</span>. <span class="id" type="var">now</span> <span class="id" type="var">easy</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#not"><span class="id" type="definition">not</span></a>. <span class="id" type="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">pose</span> (<a class="idref" href="Fin.html#fin_bounded"><span class="id" type="lemma">fin_bounded</span></a> <span class="id" type="var">n</span> <span class="id" type="var">a</span>). <span class="id" type="var">contradiction</span>.<br/>
&nbsp;&nbsp;<span class="id" type="var">contradiction</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="Injective"><span class="id" type="definition">Injective</span></a> {<span class="id" type="var">A</span> <span class="id" type="var">B</span>} (<span class="id" type="var">f</span> : <a class="idref" href="Fin.html#A"><span class="id" type="variable">A</span></a>→<a class="idref" href="Fin.html#B"><span class="id" type="variable">B</span></a>) :=<br/>
&nbsp;<span class="id" type="keyword">∀</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>, <a class="idref" href="Fin.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="Fin.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Fin.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="Fin.html#y"><span class="id" type="variable">y</span></a> → <a class="idref" href="Fin.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Fin.html#y"><span class="id" type="variable">y</span></a>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="Injective_map_NoDup"><span class="id" type="lemma">Injective_map_NoDup</span></a> <span class="id" type="var">A</span> <span class="id" type="var">B</span> (<span class="id" type="var">f</span> : <a class="idref" href="Fin.html#A"><span class="id" type="variable">A</span></a> → <a class="idref" href="Fin.html#B"><span class="id" type="variable">B</span></a>) (<span class="id" type="var">l</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#list"><span class="id" type="inductive">list</span></a> <a class="idref" href="Fin.html#A"><span class="id" type="variable">A</span></a>) :<br/>
&nbsp;<a class="idref" href="Fin.html#Injective"><span class="id" type="definition">Injective</span></a> <a class="idref" href="Fin.html#f"><span class="id" type="variable">f</span></a> → <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Lists.List.html#NoDup"><span class="id" type="inductive">NoDup</span></a> <a class="idref" href="Fin.html#l"><span class="id" type="variable">l</span></a> → <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Lists.List.html#NoDup"><span class="id" type="inductive">NoDup</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Lists.List.html#map"><span class="id" type="definition">map</span></a> <a class="idref" href="Fin.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="Fin.html#l"><span class="id" type="variable">l</span></a>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">Ij</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">induction</span> 1; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">constructor</span>; <span class="id" type="tactic">trivial</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Lists.List.html#in_map_iff"><span class="id" type="lemma">in_map_iff</span></a>. <span class="id" type="tactic">intros</span> (<span class="id" type="var">y</span> &amp; <span class="id" type="var">E</span> &amp; <span class="id" type="var">Y</span>). <span class="id" type="tactic">apply</span> <span class="id" type="var">Ij</span> <span class="id" type="keyword">in</span> <span class="id" type="var">E</span>. <span class="id" type="var">now</span> <span class="id" type="tactic">subst</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="NoDup_map_inv"><span class="id" type="lemma">NoDup_map_inv</span></a> {<span class="id" type="var">A</span> <span class="id" type="var">B</span>} {<span class="id" type="var">f</span> : <a class="idref" href="Fin.html#A"><span class="id" type="variable">A</span></a> → <a class="idref" href="Fin.html#B"><span class="id" type="variable">B</span></a>} <span class="id" type="var">l</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Lists.List.html#NoDup"><span class="id" type="inductive">NoDup</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Lists.List.html#map"><span class="id" type="definition">map</span></a> <a class="idref" href="Fin.html#f"><span class="id" type="variable">f</span></a> <a class="idref" href="Fin.html#l"><span class="id" type="variable">l</span></a>) → <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Lists.List.html#NoDup"><span class="id" type="inductive">NoDup</span></a> <a class="idref" href="Fin.html#l"><span class="id" type="variable">l</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">l</span>; <span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">inversion_clear</span> 1; <span class="id" type="tactic">subst</span>; <span class="id" type="tactic">constructor</span>; <span class="id" type="tactic">auto</span>.<br/>
&nbsp;<span class="id" type="tactic">intro</span> <span class="id" type="var">H</span>. <span class="id" type="var">now</span> <span class="id" type="tactic">apply</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Lists.List.html#in_map"><span class="id" type="lemma">in_map</span></a> <span class="id" type="var">f</span>) <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="fin_expand_inj"><span class="id" type="lemma">fin_expand_inj</span></a> {<span class="id" type="var">n</span>} (<span class="id" type="var">x</span> <span class="id" type="var">y</span>: <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Vectors.Fin.html#t"><span class="id" type="inductive">t</span></a> <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a>) (<span class="id" type="var">eq</span>: <a class="idref" href="Fin.html#fin_expand"><span class="id" type="definition">fin_expand</span></a> <a class="idref" href="Fin.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Fin.html#fin_expand"><span class="id" type="definition">fin_expand</span></a> <a class="idref" href="Fin.html#y"><span class="id" type="variable">y</span></a>): <a class="idref" href="Fin.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Fin.html#y"><span class="id" type="variable">y</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">induction</span> <span class="id" type="var">n</span>. <span class="id" type="tactic">inversion</span> <span class="id" type="var">x</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">x</span> <span class="id" type="keyword">using</span> <a class="idref" href="Fin.html#fin_Sn_inv"><span class="id" type="definition">fin_Sn_inv</span></a>;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">y</span> <span class="id" type="keyword">using</span> <a class="idref" href="Fin.html#fin_Sn_inv"><span class="id" type="definition">fin_Sn_inv</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" type="tactic">inversion</span> <span class="id" type="var">eq</span>.<br/>
&nbsp;&nbsp;- <span class="id" type="tactic">inversion</span> <span class="id" type="var">eq</span>.<br/>
&nbsp;&nbsp;- <span class="id" type="tactic">f_equal</span>. <span class="id" type="tactic">apply</span> <span class="id" type="var">IHn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">simpl</span> <span class="id" type="keyword">in</span> <span class="id" type="var">eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Vectors.Fin.html#FS_inj"><span class="id" type="definition">FS_inj</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">eq</span>. <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="NoDup_fin_cons"><span class="id" type="lemma">NoDup_fin_cons</span></a> {<span class="id" type="var">n</span>} (<span class="id" type="var">x</span> : <a class="idref" href="Fin.html#fin"><span class="id" type="definition">fin</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a>)) (<span class="id" type="var">l</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#list"><span class="id" type="inductive">list</span></a> (<a class="idref" href="Fin.html#fin"><span class="id" type="definition">fin</span></a> <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a>))<br/>
&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Lists.List.html#NoDup"><span class="id" type="inductive">NoDup</span></a> <a class="idref" href="Fin.html#l"><span class="id" type="variable">l</span></a> → <a class="idref" href="Fin.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Fin.html#last_fin_from_nat"><span class="id" type="definition">last_fin_from_nat</span></a> <a class="idref" href="Fin.html#n"><span class="id" type="variable">n</span></a> → <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Lists.List.html#NoDup"><span class="id" type="inductive">NoDup</span></a> (<a class="idref" href="Fin.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:list_scope:x_'::'_x"><span class="id" type="notation">::</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Lists.List.html#map"><span class="id" type="definition">map</span></a> <a class="idref" href="Fin.html#fin_expand"><span class="id" type="definition">fin_expand</span></a> <a class="idref" href="Fin.html#l"><span class="id" type="variable">l</span></a>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">constructor</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">H0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Fin.html#last_fin_from_nat_not_In"><span class="id" type="lemma">last_fin_from_nat_not_In</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Fin.html#Injective_map_NoDup"><span class="id" type="lemma">Injective_map_NoDup</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <a class="idref" href="Fin.html#Injective"><span class="id" type="definition">Injective</span></a>. <span class="id" type="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Fin.html#fin_expand_inj"><span class="id" type="lemma">fin_expand_inj</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assumption</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="map_fin_expand_rewrite"><span class="id" type="lemma">map_fin_expand_rewrite</span></a> : <span class="id" type="keyword">∀</span> {<span class="id" type="var">m</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a>} {<span class="id" type="var">newi</span> <span class="id" type="var">unh</span> <span class="id" type="var">act</span> <span class="id" type="var">inact</span> <span class="id" type="var">hnd</span>},<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Lists.List.html#NoDup"><span class="id" type="inductive">NoDup</span></a> (<a class="idref" href="Fin.html#newi"><span class="id" type="variable">newi</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:list_scope:x_'::'_x"><span class="id" type="notation">::</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Lists.List.html#map"><span class="id" type="definition">map</span></a> (@<a class="idref" href="Fin.html#fin_expand"><span class="id" type="definition">fin_expand</span></a> <a class="idref" href="Fin.html#m"><span class="id" type="variable">m</span></a>) (<a class="idref" href="Fin.html#unh"><span class="id" type="variable">unh</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:list_scope:x_'++'_x"><span class="id" type="notation">++</span></a> <a class="idref" href="Fin.html#act"><span class="id" type="variable">act</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:list_scope:x_'++'_x"><span class="id" type="notation">++</span></a> <a class="idref" href="Fin.html#inact"><span class="id" type="variable">inact</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:list_scope:x_'++'_x"><span class="id" type="notation">++</span></a> <a class="idref" href="Fin.html#hnd"><span class="id" type="variable">hnd</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;→ <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Lists.List.html#NoDup"><span class="id" type="inductive">NoDup</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:list_scope:x_'++'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Fin.html#newi"><span class="id" type="variable">newi</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:list_scope:x_'::'_x"><span class="id" type="notation">::</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Lists.List.html#map"><span class="id" type="definition">map</span></a> (@<a class="idref" href="Fin.html#fin_expand"><span class="id" type="definition">fin_expand</span></a> <a class="idref" href="Fin.html#m"><span class="id" type="variable">m</span></a>) <a class="idref" href="Fin.html#unh"><span class="id" type="variable">unh</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:list_scope:x_'++'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:list_scope:x_'++'_x"><span class="id" type="notation">++</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Lists.List.html#map"><span class="id" type="definition">map</span></a> <a class="idref" href="Fin.html#fin_expand"><span class="id" type="definition">fin_expand</span></a> <a class="idref" href="Fin.html#act"><span class="id" type="variable">act</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:list_scope:x_'++'_x"><span class="id" type="notation">++</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Lists.List.html#map"><span class="id" type="definition">map</span></a> <a class="idref" href="Fin.html#fin_expand"><span class="id" type="definition">fin_expand</span></a> <a class="idref" href="Fin.html#inact"><span class="id" type="variable">inact</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Init.Datatypes.html#:list_scope:x_'++'_x"><span class="id" type="notation">++</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Lists.List.html#map"><span class="id" type="definition">map</span></a> <a class="idref" href="Fin.html#fin_expand"><span class="id" type="definition">fin_expand</span></a> <a class="idref" href="Fin.html#hnd"><span class="id" type="variable">hnd</span></a>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Lists.List.html#map_app"><span class="id" type="lemma">map_app</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/distrib/8.4pl4/stdlib/Coq.Lists.List.html#app_comm_cons"><span class="id" type="lemma">app_comm_cons</span></a>. <span class="id" type="tactic">assumption</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>